FUNCTION GKVs1D::WvsT, debug=debug, nSubs=n_subs, nModes=n_modes, _extra=extra;; Purpose:;;	Use MEM analysis to create GKVs2D object ;	illustrating how the signal frequencies ;	evolve with time;; Written by W.M. Nevins;	1/2/02;copy = self -> MakeCopy()irange = copy.grid1.irangenPoints = irange[1] - irange[0] + 1nSub1 = FIX(SQRT(nPoints)) nSub2 = nPoints/100 > 10nSub = nSub1 > nSub2IF(Query_Integer(n_subs)) THEN nSub=n_SubsnCrement = nSub/2 > 1nts = nPoints/nCrement - 2nOmegas = nPointstGrid = copy.grid1tGrid = GKVsd_GRIDCOPY(tGrid)oldtValues = *tGrid.valuesnewtValues = FLTARR(nts);; check comand line for 'nModes';nModes=10IF(Query_Integer(n_modes)) THEN nModes=n_modes;; Get first MEM spectral dennsity;imin=irange[0]imax=imin+nSub-1copy -> signalwindow, axis=1, irange=[imin, imax]MEMstr = copy -> MEM(nModes=10, nOmegas=nOmegas)spectObj = MEMstr.spectrumwGrid = spectObj.grid1wGrid = GKVsd_GRIDCOPY(wGrid)spectPtr = spectObj -> GetValues()spect = *spectPtrnOmegas = N_ELEMENTS(spect)values = FLTARR(nts, nOmegas)values[0,*] = spectGKVdelete, MEMstrnewTvalues[0] = 0.5*(oldtValues[imin] + oldtValues[imax]);; Loop to get remaining spectral densities;FOR i=1, nts-1 DO BEGIN	imin = imin+nCrement+1 < irange[1] - 1	imax = imin+nSub-1 < irange[1]	copy -> signalwindow, axis=1, irange=[imin, imax]	MEMstr = copy -> MEM(nModes=nModes, nOmegas=nOmegas, _extra=extra)	spectObj = MEMstr.spectrum	spectPtr = spectObj.values	spect = FLOAT(*spectPtr)	values[i,*] = spect > 0.	GKVdelete, MEMstr	newTvalues[i] = 0.5*(oldtValues[imin] + oldtValues[imax])	IF(KEYWORD_SET(debug)) then print, imin, imaxENDFOR;; Create GKVs2D structure for output object;outStr = {GKVs2D}FOR i=0, N_TAGS({GKVs1D})-1 DO outStr.(i) = copy.(i)outStr.title = 'S!DMEM!N{' + copy.title + '}'outStr.mnemonic = 'S_' + copy.mnemonicoutStr.units = '(' + copy.units + ')*(' + tGrid.units + ')'indices = *copy.indicesoutStr.indices = PTR_NEW([indices, '*' ])outstr.values = PTR_NEW(values)vmin = MIN(values, MAX=vmax)outStr.vrange=[vmin,vmax];; Make new t-grid;PTR_FREE, tGrid.valuestGrid.values = PTR_NEW(newtValues)tmin = newtValues[0]tmax = newtValues[nts-1]tGrid.range=[tmin,tmax]tGrid.irange=[0,nts-1];; Load grid structures into output structure;outStr.grid1 = tGridoutStr.grid2 = wGrid;; Create output object;outObj = OBJ_NEW("GKVs2D", outStr);; clean up;copy -> trash;; and we're done ...;RETURN, outObjEND  ;  ****** GKVs1D::WvsT ******  ;	